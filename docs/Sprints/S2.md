# **Product Backlog – BibliotecaDigital (Plan para Sprint 2)**

## Historias Épicas (Actualizadas)

* **E1 - Gestión de Biblioteca y Usuarios:** Como administrador y usuario, quiero registrar, listar, buscar y consultar información detallada de materiales, y autenticarme en el sistema para gestionar eficientemente la biblioteca.
* **E2 - Préstamos Digitales:** Como usuario, quiero pedir prestados y devolver materiales digitalmente para acceder temporalmente a materiales.
* **E3 - Soporte Académico y Calidad:** Como administrador y desarrollador, quiero generar citas en APA y tener pruebas unitarias para garantizar calidad y utilidad académica.
* **E4 - Persistencia de Datos con JPA:** Como desarrollador, quiero que toda la información de la aplicación se guarde en una base de datos para que los datos no se pierdan al cerrar el programa.
    * *Incluye: HU-11, HU-12*
* **E5 - Interfaz Gráfica de Administración (CRUDs):** Como administrador, quiero interfaces gráficas de usuario para gestionar todos los registros del sistema de forma visual e intuitiva.
    * *Incluye: HU-13, HU-14, HU-15, HU-16*

***
## Historias de Usuario para el Sprint 2 

### **HU-11 – Configuración de la Capa de Persistencia (JPA y SQLite)**
* **Historia de Usuario:** Como desarrollador, quiero configurar JPA en el proyecto y conectarlo a una base de datos SQLite para establecer la base de la persistencia de datos.
* **Criterios de Aceptación:**
    * El proyecto debe incluir las dependencias de Maven para Hibernate y el conector de SQLite.
    * Debe existir un archivo `persistence.xml` que configure la conexión a la base de datos SQLite.
    * Las clases del modelo (`Usuario`, `MaterialBiblioteca`, `Autor`, `Prestamo`, etc.) deben estar anotadas como entidades JPA (`@Entity`, `@Id`, etc.).
* **Tareas Técnicas:**
    * Añadir dependencias de `hibernate-core` y `sqlite-jdbc` al `pom.xml`.
    * Crear el archivo `src/main/resources/META-INF/persistence.xml`.
    * Modificar todas las clases del paquete `domain.model` para añadir las anotaciones de JPA.

---
### **HU-12 – Migración del Repositorio a JPA**
* **Historia de Usuario:** Como desarrollador, quiero reemplazar la implementación `InMemoryBibliotecaRepository` por una nueva `JpaBibliotecaRepository` que utilice JPA para interactuar con la base de datos.
* **Criterios de Aceptación:**
    * Debe existir una nueva clase `JpaBibliotecaRepository` que implemente la interfaz `BibliotecaService`.
    * Todos los métodos de la interfaz deben ser implementados usando `EntityManager` de JPA.
    * La clase principal de la aplicación (`BibliotecaDigital.java`) debe instanciar `JpaBibliotecaRepository`.
* **Tareas Técnicas:**
    * Crear la clase `JpaBibliotecaRepository.java`.
    * Implementar los métodos de la interfaz utilizando `EntityManagerFactory` y `EntityManager`.
    * Usar consultas JPQL (`em.createQuery(...)`) para búsquedas y listados.
    * Modificar `BibliotecaDigital.java` para inyectar la nueva implementación.

---
### **HU-13 – Creación de la Interfaz Gráfica (CRUD) para Materiales**
* **Historia de Usuario:** Como administrador, quiero una interfaz gráfica completa para gestionar los materiales de la biblioteca (Crear, Leer, Actualizar, Borrar) que interactúe con la base de datos.
* **Criterios de Aceptación:**
    * Debe existir una ventana (JFrame) que muestre todos los materiales en una tabla.
    * La ventana debe contener botones para "Añadir", "Editar" y "Eliminar".
    * Las operaciones deben persistir los cambios en la base de datos y la tabla debe refrescarse automáticamente.
* **Tareas Técnicas:**
    * **(Como en FlashNotes)** Crear la interfaz `GestionMaterialesViewInterface.java`.
    * **(Como en FlashNotes)** Crear la clase `GestionMaterialesView.java` (el JFrame).
    * **(Como en FlashNotes)** Crear la clase `GestionMaterialesController.java`.
    * Modificar `BibliotecaDigital.java` para inicializar y mostrar esta nueva vista MVC.

---
### **HU-14 – Creación de la Interfaz Gráfica (CRUD) para Autores**
* **Historia de Usuario:** Como administrador, quiero una interfaz gráfica dedicada para gestionar los autores de la biblioteca de forma independiente a los materiales.
* **Criterios de Aceptación:**
    * Una ventana debe mostrar todos los autores en una tabla.
    * La ventana debe tener botones para "Añadir", "Editar" y "Eliminar".
    * Las operaciones deben persistir los cambios en la base de datos y la tabla debe refrescarse.
* **Tareas Técnicas:**
    * Crear la tríada MVC: `GestionAutoresViewInterface`, `GestionAutoresView`, y `GestionAutoresController`.
    * Asegurar que `BibliotecaService` contenga los métodos necesarios para el CRUD de autores.

---
### **HU-15 – Creación de la Interfaz Gráfica (CRUD) para Usuarios**
* **Historia de Usuario:** Como administrador, quiero una interfaz gráfica para gestionar los usuarios del sistema, permitiendo crear cuentas, modificar roles y eliminar usuarios.
* **Criterios de Aceptación:**
    * Una ventana debe mostrar todos los usuarios registrados (sin información sensible).
    * La interfaz debe permitir crear nuevos usuarios especificando nombre, email, contraseña y rol.
    * Debe ser posible editar un usuario para cambiar su nombre o su rol.
* **Tareas Técnicas:**
    * Crear la tríada MVC: `GestionUsuariosViewInterface`, `GestionUsuariosView`, y `GestionUsuariosController`.

---
### **HU-16 – Interfaz Gráfica para Gestión de Préstamos**
* **Historia de Usuario:** Como bibliotecario, quiero una interfaz gráfica para gestionar el ciclo de vida de los préstamos, incluyendo la creación de nuevos "tickets" y la visualización de los préstamos activos.
* **Criterios de Aceptación:**
    * Una ventana principal debe listar todos los préstamos existentes.
    * Un botón "Nuevo Préstamo" debe abrir un diálogo para crear un nuevo ticket.
    * El diálogo de creación debe permitir seleccionar un usuario, buscar materiales disponibles, añadirlos al ticket y confirmar el préstamo.
* **Tareas Técnicas:**
    * Crear la tríada MVC: `GestionPrestamosViewInterface`, `GestionPrestamosView`, y `GestionPrestamosController`.
    * Diseñar un `JDialog` para el formulario de nuevo préstamo.

***
## **Tabla Resumen Backlog para Sprint 2**

| Título | Descripción | Etiqueta | Prioridad |
| :--- | :--- | :--- | :--- |
| **HU-11 – Configuración de Persistencia** | "Como desarrollador, quiero configurar JPA y SQLite." | Sprint 2 | **Crítica** |
| **HU-12 – Migración del Repositorio** | "Como desarrollador, quiero reemplazar el repositorio en memoria por uno con JPA." | Sprint 2 | **Crítica** |
| **HU-13 – CRUD GUI de Materiales** | "Como administrador, quiero una GUI para gestionar los materiales." | Sprint 2 | **Alta** |
| **HU-15 – CRUD GUI de Usuarios** | "Como admin, quiero una GUI para gestionar usuarios y roles." | Sprint 2 | **Alta** |
| **HU-14 – CRUD GUI de Autores** | "Como admin, quiero una GUI para gestionar autores." | Sprint 2 | Media |
| **HU-16 – GUI de Préstamos** | "Como bibliotecario, quiero una GUI para crear y ver préstamos." | Sprint 2 | **Alta** |

---
## **Orden de Implementación Sugerido para Sprint 2**

El orden es crucial para un sprint tan denso. Sigue estos pasos para asegurar el éxito:

1.  **La Fundación (HU-11 y HU-12):** Dedica la primera parte del sprint a configurar la base de datos y migrar tu repositorio. **No empieces ninguna GUI hasta que esto funcione**. Asegúrate de que tus pruebas de consola anteriores ahora guardan datos en un archivo SQLite.
2.  **El Primer CRUD (HU-13):** Construye la GUI para **Materiales**. Esta es la más compleja y te servirá de plantilla para las demás.
3.  **Los CRUDs Sencillos (HU-14 y HU-15):** Una vez que tengas la plantilla del CRUD de materiales, crear las GUIs para **Autores** y **Usuarios** será mucho más rápido.
4.  **La Funcionalidad Principal (HU-16):** Termina con la GUI de **Préstamos**. Es la más desafiante porque no es un CRUD simple, sino una transacción que involucra a múltiples entidades.